(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5c4cc84f"],{"3a1e":function(e,t,r){},a9da:function(e,t,r){"use strict";r("3a1e")},bb51:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"col main-container main-area-rwd vh100scroll"},[r("NewTweet",{on:{"after-create-tweet":e.afterCreateTweet}}),r("Tweets",{attrs:{initialTweets:e.tweets}})],1)},n=[],i=(r("a4d3"),r("e01a"),r("b0c0"),r("96cf"),r("1da1")),s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"new-tweet-container"},[r("div",{staticClass:"title"},[e._v("首頁")]),r("div",{staticClass:"user-area"},[r("div",{staticClass:"avator-and-tweet"},[r("router-link",{attrs:{to:{name:"user",params:{userId:e.currentUser.id}}}},[r("img",{staticClass:"user-avator",attrs:{src:e.userProfile.avatar||"https://i.imgur.com/S4PE66O.png",alt:""}})]),r("form",{staticClass:"new-tweet d-flex flex-column",on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.handleSubmit(t)}}},[r("label",{staticClass:"form-label",attrs:{for:"tweet-textarea"}}),r("textarea",{directives:[{name:"model",rawName:"v-model",value:e.description,expression:"description"}],staticClass:"form-control",attrs:{id:"tweet-textarea",rows:"3",placeholder:"有什麼新鮮事？"},domProps:{value:e.description},on:{input:function(t){t.target.composing||(e.description=t.target.value)}}}),r("div",{staticClass:"new-tweets-btn-box d-flex justify-content-end"},[e.description.length?r("div",[r("span",{staticClass:"contentAlert",class:{fontRed:e.isDescriptionOverSize}},[e._v(e._s(e.description.length))]),r("span",{staticClass:"contentAlert mr-3"},[e._v("/140")])]):e._e(),r("button",{staticClass:"btn btn-primary",attrs:{type:"submit",id:"tweet-submit-btn"}},[e._v(" 推文 ")])])])],1)])])},o=[],c=(r("498a"),r("5530")),u=r("1602"),l=r("2fa3"),d=r("ec26"),f=r("2f62"),p={data:function(){return{avatar:"",userProfile:{},id:-1,description:"",createdAt:""}},computed:Object(c["a"])(Object(c["a"])({},Object(f["b"])(["currentUser","isAuthenticated"])),{},{isDescriptionOverSize:function(){return this.description.length>140}}),created:function(){var e=this.currentUser.id;this.fetchUserProfile(e)},methods:{fetchUserProfile:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,u["a"].getUserProfile({userId:e});case 3:if(a=r.sent,t.userProfile=Object(c["a"])(Object(c["a"])({},t.userProfile),a.data),200===a.status){r.next=7;break}throw new Error(a);case 7:r.next=13;break;case 9:r.prev=9,r.t0=r["catch"](0),console.log(r.t0),l["a"].fire({icon:"error",title:"無法取得使用者資料，請稍後再試"});case 13:case"end":return r.stop()}}),r,null,[[0,9]])})))()},handleSubmit:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""!==e.description.trim()){t.next=5;break}return l["a"].fire({icon:"error",title:"親愛的用戶，請勿發空空的思念。"}),t.abrupt("return");case 5:if(!(e.description.length>140)){t.next=8;break}return l["a"].fire({icon:"error",title:"推文字數超過140囉！"}),t.abrupt("return");case 8:return t.prev=8,e.createdAt=Date.now(),t.next=12,u["a"].addUserNewTweet({description:e.description,createdAt:e.createdAt});case 12:if(r=t.sent,200===r.status){t.next=15;break}throw new Error(r);case 15:e.$emit("after-create-tweet",{User:{id:e.userProfile.id,account:e.userProfile.account,name:e.userProfile.name,avatar:e.userProfile.avatar},id:Object(d["a"])(),name:e.userProfile.name,description:e.description,createdAt:e.createdAt,repliesCount:0,likesCount:0,isLiked:!1}),e.description="",t.next=23;break;case 19:t.prev=19,t.t0=t["catch"](8),console.log(t.t0),l["a"].fire({icon:"error",title:"無法取得使用者資料，請稍後再試"});case 23:case"end":return t.stop()}}),t,null,[[8,19]])})))()}}},w=p,m=(r("a9da"),r("2877")),v=Object(m["a"])(w,s,o,!1,null,"ce2fb42c",null),b=v.exports,h=r("c136"),g=r("7482"),C={components:{NewTweet:b,Tweets:h["a"]},props:{newTweetsPayload:{type:Object,required:!0}},data:function(){return{tweets:[]}},watch:{newTweetsPayload:function(e){this.afterCreateTweet(e)}},created:function(){this.fetchTweets()},methods:{fetchTweets:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,g["a"].getAllTweets();case 3:r=t.sent,a=r.data,e.tweets=a,t.next=12;break;case 8:t.prev=8,t.t0=t["catch"](0),console.log(t.t0),l["a"].fire({icon:"error",title:"無法取得推文，請稍後再試"});case 12:case"end":return t.stop()}}),t,null,[[0,8]])})))()},afterCreateTweet:function(e){var t=e.User,r=e.id,a=e.name,n=e.description,i=e.createdAt,s=e.repliesCount,o=e.likesCount,c=e.isLiked;this.tweets.unshift({User:t,id:r,name:a,description:n,createdAt:i,repliesCount:s,likesCount:o,isLiked:c})},afterClickDeleteLike:function(e){console.log("payload",e)}}},x=C,k=Object(m["a"])(x,a,n,!1,null,"b0a937be",null);t["default"]=k.exports},ec26:function(e,t,r){"use strict";var a,n=new Uint8Array(16);function i(){if(!a&&(a="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),!a))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(n)}var s=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function o(e){return"string"===typeof e&&s.test(e)}for(var c=o,u=[],l=0;l<256;++l)u.push((l+256).toString(16).substr(1));function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(u[e[t+0]]+u[e[t+1]]+u[e[t+2]]+u[e[t+3]]+"-"+u[e[t+4]]+u[e[t+5]]+"-"+u[e[t+6]]+u[e[t+7]]+"-"+u[e[t+8]]+u[e[t+9]]+"-"+u[e[t+10]]+u[e[t+11]]+u[e[t+12]]+u[e[t+13]]+u[e[t+14]]+u[e[t+15]]).toLowerCase();if(!c(r))throw TypeError("Stringified UUID is invalid");return r}var f=d;function p(e,t,r){e=e||{};var a=e.random||(e.rng||i)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){r=r||0;for(var n=0;n<16;++n)t[r+n]=a[n];return t}return f(a)}t["a"]=p}}]);
//# sourceMappingURL=chunk-5c4cc84f.5a00d6b5.js.map